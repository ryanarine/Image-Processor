(window.webpackJsonpimage=window.webpackJsonpimage||[]).push([[0],{21:function(e,t,a){e.exports=a(33)},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),c=a.n(i),l=a(2),o=a(12),s=a(19),u=a(9),p=a(20),h=a(5);function g(e,t,a){for(var n=!0,r=0;r<4;r++)n=n&&Math.abs(e[r]-t[r])<=a[r];return n}function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={imgData:null,newData:null,x1:0,x2:0,y1:0,y2:0,sample:!1,pixel:null},v={GRAYSCALE:function(e){for(var t=0,a=0;a<e.length;a+=4)t=Math.round((e[a]+e[a+1]+e[a+2])/3),e[a]=t,e[a+1]=t,e[a+2]=t},NEGATIVE:function(e){for(var t=0;t<e.length;t+=4)e[t]=255-e[t],e[t+1]=255-e[t+1],e[t+2]=255-e[t+2]},BRIGHT:function(e,t){for(var a=0;a<e.length;a+=4)e[a]=e[a]*t>255?255:e[a]*t,e[a+1]=e[a+1]*t>255?255:e[a+1]*t,e[a+2]=e[a+2]*t>255?255:e[a+2]*t},REPLACE:function(e,t,a,n){for(var r=0;r<e.length;r+=4)if(g([e[r],e[r+1],e[r+2],e[r+3]],t,n))for(var i=0;i<4;i++)e[r+i]=a[i]}};function b(e,t,a){var n=document.getElementById("newCanvas");n.getContext("2d").putImageData(a,-e,-t,e,t,n.scrollWidth,n.scrollHeight)}function E(e,t){e.forEach((function(e,a){return t[a]=e}))}function y(e){document.getElementById("container").className=e?"container":"container cross"}var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET":return t.isNewCanvas?m({},e,{newData:t.data}):m({},e,{imgData:t.data});case"REFRESH":return m({},e,{x1:0,x2:0,y1:0,y2:0,sample:!1,pixel:null});case"POINT":return t.isNewCanvas?m({},e,{x2:t.x,y2:t.y}):m({},e,{x1:t.x,y1:t.y});case"PIXEL":return y(e.sample),t.pixel?m({},e,{sample:!1,pixel:t.pixel}):m({},e,{sample:!1});case"SAMPLE":return y(e.sample),m({},e,{sample:!e.sample});case"BASIC":if(e.newData){var a=v[t.effect];E(e.imgData.data,e.newData.data),t.payload?a.apply(void 0,[e.newData.data].concat(Object(p.a)(t.payload))):a(e.newData.data),b(e.x2,e.y2,e.newData)}return e;case"SECTION":if(e.pixel&&e.newData){var n=function(e,t,a){var n=[e.width,e.height,e.data],r=n[0],i=n[1],c=n[2],l=[[0,-1],[1,0],[0,1],[-1,0]],o=new Array(r*i),s=[],p=[t[0],t[1],t[2],t[3]],h=[t[4],t[5]],f=h[0],m=h[1],d=[[f,m]];for(o[m*r+f]=!0;0!==d.length;){var v=d.pop(),b=Object(u.a)(v,2);if(f=b[0],m=b[1],!(f<0||f>r||m<0||m>i)){for(var E=[],y=0;y<4;y++)E.push(c[m*r*4+4*f+y]);g(E,p,a)&&(s.push(m*r*4+4*f),l.forEach((function(e){o[(m+e[1])*r+f+e[0]]||(o[(m+e[1])*r+f+e[0]]=!0,d.push([f+e[0],m+e[1]]))})))}}return s}(e.imgData,e.pixel,t.tolerance),r=e.newData.data;E(e.imgData.data,e.newData.data);var i=t.newVal;n.forEach((function(e){r[e]=i[0],r[e+1]=i[1],r[e+2]=i[2],r[e+3]=i[3]})),b(e.x2,e.y2,e.newData)}return e;case"SWAP":if(e.imgData){var c=t.copyToNew?["newCanvas",e.imgData,e.x2,e.y2]:["canvas",e.newData,e.x1,e.y1],l=Object(u.a)(c,4),o=l[0],s=l[1],h=l[2],f=l[3],w=document.getElementById(o);w.getContext("2d").putImageData(s,-h,-f,h,f,w.scrollWidth,w.scrollHeight);var C=new Uint8ClampedArray(s.data),O=new ImageData(C,s.width,s.height);return t.copyToNew?m({},e,{newData:O}):m({},e,{imgData:O})}return e;default:return e}},C=a(6),O=a(7),D=a(11),x=a(8),j=a(1),k=a(10),I=function(e,t){return{type:"BASIC",effect:e,payload:t}},P=function(e){return{type:"SWAP",copyToNew:e}},N=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(D.a)(this,Object(x.a)(t).call(this))).state={fcr:255,fcg:255,fcb:255,fca:255,rcr:255,rcg:255,rcb:255,rca:255,tcr:10,tcg:10,tcb:10,tca:10},e.onChange=e.onChange.bind(Object(j.a)(e)),e.replace=e.replace.bind(Object(j.a)(e)),e.section=e.section.bind(Object(j.a)(e)),e.click=e.click.bind(Object(j.a)(e)),e.navigate=e.navigate.bind(Object(j.a)(e)),e}return Object(k.a)(t,e),Object(O.a)(t,[{key:"onChange",value:function(e){var t=Number(e.target.value);if(!isNaN(t)&&t>=0&&t<=255){t=Number(t.toFixed());var a=Object(h.a)({},e.target.name,t);this.setState(a)}}},{key:"replace",value:function(e){e.preventDefault();var t=this.state,a=[t.fcr,t.fcg,t.fcb,t.fca],n=[t.rcr,t.rcg,t.rcb,t.rca],r=[t.tcr,t.tcg,t.tcb,t.tca];this.props.basicImgEffect("REPLACE",[a,n,r])}},{key:"click",value:function(e){e.preventDefault(),this.props.switchSample()}},{key:"section",value:function(e){e.preventDefault();var t=this.props.pixel,a=this.state;if(t&&t[0]===a.fcr&&t[1]===a.fcg&&t[2]===a.fcb&&t[3]===a.fca){var n=[a.rcr,a.rcg,a.rcb,a.rca],r=[a.tcr,a.tcg,a.tcb,a.tca];this.props.section(n,r)}else alert("You must first specify a section to paint. Click the cursor icon and then click on an area of the canvas.")}},{key:"navigate",value:function(e){var t=e.which;if(t>=37&&t<=40){var a=e.target.parentElement,n=e.target.name,r=n[0],i=n[2],c="f"===r?1:"r"===r?2:3;c+="r"===i?0:"g"===i?3:"b"===i?6:9,37===t?c-=0===e.target.selectionStart?1:c:38===t?c-=3:c+=39===t?e.target.selectionStart===e.target.value.length?1:12:3,c>=1&&c<=12&&a[c].focus()}}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{id:"e",className:"replaceGrid",onKeyDown:this.navigate},r.a.createElement("label",null),r.a.createElement("span",null,r.a.createElement("label",null,"Find"),r.a.createElement("button",{onClick:this.click,title:"Click section on canvas",className:"infoTool"},r.a.createElement("i",{id:"clickIcon"},"\xa0\xa0\xa0\xa0"))),r.a.createElement("label",null,"Replace"),r.a.createElement("label",null,"Tolerance"),r.a.createElement("label",null,"Red:"),r.a.createElement("input",{type:"text",value:this.state.fcr,onChange:function(t){return e.onChange(t)},name:"fcr"}),r.a.createElement("input",{type:"text",value:this.state.rcr,onChange:function(t){return e.onChange(t)},name:"rcr"}),r.a.createElement("input",{type:"text",value:this.state.tcr,onChange:function(t){return e.onChange(t)},name:"tcr"}),r.a.createElement("label",null,"Green:"),r.a.createElement("input",{type:"text",value:this.state.fcg,onChange:function(t){return e.onChange(t)},name:"fcg"}),r.a.createElement("input",{type:"text",value:this.state.rcg,onChange:function(t){return e.onChange(t)},name:"rcg"}),r.a.createElement("input",{type:"text",value:this.state.tcg,onChange:function(t){return e.onChange(t)},name:"tcg"}),r.a.createElement("label",null,"Blue:"),r.a.createElement("input",{type:"text",value:this.state.fcb,onChange:function(t){return e.onChange(t)},name:"fcb"}),r.a.createElement("input",{type:"text",value:this.state.rcb,onChange:function(t){return e.onChange(t)},name:"rcb"}),r.a.createElement("input",{type:"text",value:this.state.tcb,onChange:function(t){return e.onChange(t)},name:"tcb"}),r.a.createElement("label",null,"Alpha:"),r.a.createElement("input",{type:"text",value:this.state.fca,onChange:function(t){return e.onChange(t)},name:"fca"}),r.a.createElement("input",{type:"text",value:this.state.rca,onChange:function(t){return e.onChange(t)},name:"rca"}),r.a.createElement("input",{type:"text",value:this.state.tca,onChange:function(t){return e.onChange(t)},name:"tca"}),r.a.createElement("div",{id:"replaceBtns"},r.a.createElement("button",{onClick:this.replace},"Replace Colour"),r.a.createElement("button",{onClick:this.section},"Replace Section Colour")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.pixel){var a=e.pixel;return t.pixel&&t.pixel[4]===a[4]&&t.pixel[5]===a[5]?null:{fcr:a[0],fcg:a[1],fcb:a[2],fca:a[3],pixel:a}}return null}}]),t}(n.Component),S=Object(l.b)((function(e){return{pixel:e.pixel}}),{switchSample:function(){return{type:"SAMPLE"}},basicImgEffect:I,section:function(e,t){return{type:"SECTION",newVal:e,tolerance:t}}})(N);a(31);var A=function(){return r.a.createElement("div",null,r.a.createElement(S,null))},T=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(D.a)(this,Object(x.a)(t).call(this))).state={val:0},e.handleChange=e.handleChange.bind(Object(j.a)(e)),e.handleClick=e.handleClick.bind(Object(j.a)(e)),e}return Object(k.a)(t,e),Object(O.a)(t,[{key:"handleChange",value:function(e){var t=e.target.value;!isNaN(t)&&t>=0&&t<=500&&(t=Number(Number(t).toFixed()),this.setState({val:t}))}},{key:"handleClick",value:function(){this.props.basicImgEffect("BRIGHT",[this.props.multiplier(this.state.val)])}},{key:"render",value:function(){var e=this.props.text||"Lighten";return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleClick}," ",e),r.a.createElement("input",{type:"text",value:this.state.val,onChange:this.handleChange,style:{width:"25px"}}),r.a.createElement("label",null,"%"))}}]),t}(n.Component),R=Object(l.b)((function(){return{}}),{basicImgEffect:I})(T);var B=function(){var e=Object(l.c)();return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr",justifyItems:"center"}},r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e(I("GRAYSCALE"))}}," Grayscale "),r.a.createElement("button",{onClick:function(){return e(I("NEGATIVE"))}}," Negative "),r.a.createElement(R,{multiplier:function(e){return e/100+1}}),r.a.createElement(R,{multiplier:function(e){return 100/(e+100)},text:"Darken"})))};a(32);var L=function(e){var t=Object(l.c)();return r.a.createElement("div",null,r.a.createElement("input",{id:"upload",type:"file",onChange:e.change,hidden:!0}),r.a.createElement("button",{onClick:function(){return document.getElementById("upload").click()}},"Upload Image"),r.a.createElement("button",{onClick:function(){return t(P(!1))}},r.a.createElement("i",{id:"leftIcon",title:"Copy new preview to old"},"\xa0\xa0\xa0\xa0\xa0\xa0")))};var G=function(e){var t=Object(l.c)();return r.a.createElement("div",null,r.a.createElement("button",{onClick:e.download},"Download"),r.a.createElement("button",{onClick:function(){return t(P(!0))}},r.a.createElement("i",{id:"rightIcon",title:"Copy old preview to new"},"\xa0\xa0\xa0\xa0\xa0\xa0")),r.a.createElement("a",{id:"download",href:"/",style:{display:"none"},download:"converted"},"Download"))};function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var F=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(D.a)(this,Object(x.a)(t).call(this))).imageChange=e.imageChange.bind(Object(j.a)(e)),e.download=e.download.bind(Object(j.a)(e)),e.recenter=e.recenter.bind(Object(j.a)(e)),e.handleClick=e.handleClick.bind(Object(j.a)(e)),e}return Object(k.a)(t,e),Object(O.a)(t,[{key:"imageChange",value:function(e){var t=this,a=e.target.files[0];if(a){var n=new Image,r=new FileReader;r.onload=function(e){n.onload=function(e){var a=document.createElement("canvas"),n=e.target,r=n.width,i=n.height;a.width=r,a.height=i,a.getContext("2d").drawImage(n,0,0,r,i);var c=a.getContext("2d").getImageData(0,0,r,i);(a=document.getElementById("canvas")).width=a.scrollWidth,a.height=a.scrollHeight;var l=a.getContext("2d");(a=document.getElementById("newCanvas")).width=a.scrollWidth,a.height=a.scrollHeight,t.props.setImgData(!1,c).then((function(){l.putImageData(t.props.imgData,0,0,0,0,a.scrollWidth,a.scrollHeight),t.props.swap(!0)})),t.props.refresh()};var a=e.target.result;a.startsWith("data:image")?n.src=a:alert("That file type is not supported")},r.readAsDataURL(a)}e.target.value=""}},{key:"download",value:function(){var e=document.getElementById("download");if(this.props.imgData){var t=document.createElement("canvas");t.width=this.props.imgData.width,t.height=this.props.imgData.height,t.getContext("2d").putImageData(this.props.newData,0,0),e.setAttribute("href",t.toDataURL()),e.click()}}},{key:"recenter",value:function(e){var t=e.target;if(this.props.imgData&&(this.props.imgData.width>t.width||this.props.imgData.height>t.height)){var a=t.getContext("2d"),n="canvas"===t.id?[this.props.x1,this.props.y1,this.props.imgData]:[this.props.x2,this.props.y2,this.props.newData],r=Object(u.a)(n,3),i=r[0],c=r[1],l=r[2],o=t.width/2,s=[i+e.pageX-t.offsetLeft-o,c+e.pageY-t.offsetTop-o];if(l.width<t.width||s[0]<0?s[0]=0:s[0]=s[0]>l.width-t.width?l.width-t.width:s[0],l.height<t.height||s[1]<0?s[1]=0:s[1]=s[1]>l.height-t.height?l.height-t.height:s[1],s[0]!==i||s[1]!==c){this.props.updatePoint("newCanvas"===t.id,s[0],s[1]);var p=[l.width,l.height],h=p[0],g=p[1],f=h-s[0],m=g-s[1];f=Math.min(t.width,f),m=Math.min(t.height,m);for(var d=new Uint8ClampedArray(f*m*4),v=0;v<m;v++)for(var b=0;b<f;b++)for(var E=0;E<4;E++)d[v*f*4+4*b+E]=l.data[(s[1]+v)*h*4+4*(s[0]+b)+E];l=new ImageData(d,f,m),a.putImageData(l,0,0)}}}},{key:"handleClick",value:function(e){if(this.props.imgData&&this.props.sample&&"canvas"===e.target.id){var t=e.target,a=[e.pageX-t.offsetLeft+this.props.x1,e.pageY-t.offsetTop+this.props.y1];if(a[0]>=0&&a[0]<=this.props.imgData.width&&a[1]>=0&&a[1]<=this.props.imgData.height){var n=[this.props.imgData.data[a[1]*this.props.imgData.width*4+4*a[0]],this.props.imgData.data[a[1]*this.props.imgData.width*4+4*a[0]+1],this.props.imgData.data[a[1]*this.props.imgData.width*4+4*a[0]+2],this.props.imgData.data[a[1]*this.props.imgData.width*4+4*a[0]+3],a[0],a[1]];this.props.updatePixel(n)}}else this.props.sample?this.props.updatePixel():this.recenter(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"container",id:"container"},r.a.createElement("div",{className:"grid"},r.a.createElement("label",null,"Old Preview"),r.a.createElement("label",null,"New Preview"),r.a.createElement("div",{className:"transparent"},r.a.createElement("canvas",{id:"canvas",onClick:this.handleClick})),r.a.createElement("div",{className:"transparent"},r.a.createElement("canvas",{id:"newCanvas",onClick:this.handleClick})),r.a.createElement(L,{change:this.imageChange}),r.a.createElement(G,{download:this.download})),r.a.createElement(A,null),r.a.createElement(B,null))}},{key:"shouldComponentUpdate",value:function(){return!1}}]),t}(n.Component),W=Object(l.b)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)}),{setImgData:function(e,t){return function(a){return a({type:"SET",isNewCanvas:e,data:t}),Promise.resolve()}},refresh:function(){return{type:"REFRESH"}},updatePoint:function(e,t,a){return{type:"POINT",isNewCanvas:e,x:t,y:a}},updatePixel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"PIXEL",pixel:e}},basicImgEffect:I,swap:P})(F),M=Object(o.c)(w,d,Object(o.a)(s.a));c.a.render(r.a.createElement(l.a,{store:M},r.a.createElement(W,null)),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.9074bcb8.chunk.js.map