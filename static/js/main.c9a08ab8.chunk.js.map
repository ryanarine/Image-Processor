{"version":3,"sources":["Replace.js","Tools.js","App.js","index.js"],"names":["btnStyle","display","margin","Replace","state","fcr","fcg","fcb","fca","rcr","rcg","rcb","rca","tcr","tcg","tcb","tca","onChange","bind","event","value","Number","target","isNaN","name","this","setState","onSubmit","e","props","submit","className","type","style","Component","Tools","replace","file","input","preventDefault","replaceColour","App","imgData","newData","imageChange","download","loadImage","swapImage","changeImgData","files","img","Image","reader","FileReader","onload","read","imgEvent","canvas","document","createElement","width","height","getContext","drawImage","getImageData","filedata","result","startsWith","src","alert","readAsDataURL","getElementById","scrollWidth","scrollHeight","ctx","putImageData","copyNew","canvasName","imgFile","data","Uint8ClampedArray","copy","ImageData","file1","file2","oldVal","newVal","tolerance","match","imgData1","imgData2","i","length","offset","Math","abs","link","setAttribute","toDataURL","click","id","hidden","onClick","href","ReactDOM","render"],"mappings":"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","file":"static/js/main.c9a08ab8.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./Replace.css\";\r\n\r\nconst btnStyle = {\r\n  display: \"block\",\r\n  margin: \"10px auto\"\r\n};\r\n\r\nclass Replace extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      fcr: 255,\r\n      fcg: 255,\r\n      fcb: 255,\r\n      fca: 255,\r\n      rcr: 255,\r\n      rcg: 255,\r\n      rcb: 255,\r\n      rca: 255,\r\n      tcr: 10,\r\n      tcg: 10,\r\n      tcb: 10,\r\n      tca: 10\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n  }\r\n\r\n  onChange(event) {\r\n    let value = Number(event.target.value);\r\n    if (!isNaN(value) && value >= 0 && value <= 255) {\r\n      let state = { [event.target.name]: value };\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <form onSubmit={e => this.props.submit(this.state, e)}>\r\n        <div className=\"replaceGrid\">\r\n          <label></label>\r\n          <label>Find</label>\r\n          <label>Replace</label>\r\n          <label>Tolerance</label>\r\n          <label>Red:</label>\r\n          <input type=\"text\" value={this.state.fcr} onChange={e => this.onChange(e)} name=\"fcr\" />\r\n          <input type=\"text\" value={this.state.rcr} onChange={e => this.onChange(e)} name=\"rcr\" />\r\n          <input type=\"text\" value={this.state.tcr} onChange={e => this.onChange(e)} name=\"tcr\" />\r\n          <label>Green:</label>\r\n          <input type=\"text\" value={this.state.fcg} onChange={e => this.onChange(e)} name=\"fcg\" />\r\n          <input type=\"text\" value={this.state.rcg} onChange={e => this.onChange(e)} name=\"rcg\" />\r\n          <input type=\"text\" value={this.state.tcg} onChange={e => this.onChange(e)} name=\"tcg\" />\r\n          <label>Blue:</label>\r\n          <input type=\"text\" value={this.state.fcb} onChange={e => this.onChange(e)} name=\"fcb\" />\r\n          <input type=\"text\" value={this.state.rcb} onChange={e => this.onChange(e)} name=\"rcb\" />\r\n          <input type=\"text\" value={this.state.tcb} onChange={e => this.onChange(e)} name=\"tcb\" />\r\n          <label>Alpha:</label>\r\n          <input type=\"text\" value={this.state.fca} onChange={e => this.onChange(e)} name=\"fca\" />\r\n          <input type=\"text\" value={this.state.rca} onChange={e => this.onChange(e)} name=\"rca\" />\r\n          <input type=\"text\" value={this.state.tca} onChange={e => this.onChange(e)} name=\"tca\" />\r\n        </div>\r\n        <button style={btnStyle} type=\"submit\">\r\n          Replace Colour\r\n        </button>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Replace;\r\n","import React from \"react\";\r\nimport Replace from \"./Replace\";\r\n\r\nfunction replaceColour(replace, file, input, event) {\r\n  event.preventDefault();\r\n  let oldVal = [input.fcr, input.fcg, input.fcb, input.fca];\r\n  let newVal = [input.rcr, input.rcg, input.rcb, input.rca];\r\n  let tolerance = [input.tcr, input.tcg, input.tcb, input.tca];\r\n  replace(file, oldVal, newVal, tolerance);\r\n}\r\n\r\nfunction Tools(props) {\r\n  return (\r\n    <div>\r\n      <Replace submit={(state, event) => replaceColour(props.replace, props.file, state, event)} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Tools;\r\n","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport Tools from \"./Tools\";\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = { imgData: null, newData: null };\n    this.imageChange = this.imageChange.bind(this);\n    this.download = this.download.bind(this);\n    this.loadImage = this.loadImage.bind(this);\n    this.swapImage = this.swapImage.bind(this);\n    this.changeImgData = this.changeImgData.bind(this);\n    this.replace = this.replace.bind(this);\n  }\n\n  imageChange(event) {\n    const file = event.target.files[0];\n    if (file) {\n      let img = new Image();\n      const reader = new FileReader();\n      reader.onload = read => {\n        img.onload = imgEvent => {\n          var canvas = document.createElement(\"canvas\");\n          let img = imgEvent.target;\n          let width = img.width;\n          let height = img.height;\n          canvas.width = width;\n          canvas.height = height;\n          canvas.getContext(\"2d\").drawImage(img, 0, 0, width, height);\n          let imgData = canvas.getContext(\"2d\").getImageData(0, 0, width, height);\n          this.setState({ imgData }, this.loadImage);\n        };\n        let filedata = read.target.result;\n        if (filedata.startsWith(\"data:image\")) {\n          img.src = filedata;\n        } else {\n          alert(\"That file type is not supported\");\n        }\n      };\n      reader.readAsDataURL(file);\n    }\n    event.target.value = \"\";\n  }\n\n  loadImage() {\n    var canvas = document.getElementById(\"canvas\");\n    canvas.width = canvas.scrollWidth;\n    canvas.height = canvas.scrollHeight;\n    const ctx = canvas.getContext(\"2d\");\n    canvas = document.getElementById(\"newCanvas\");\n    canvas.width = canvas.scrollWidth;\n    canvas.height = canvas.scrollHeight;\n    ctx.putImageData(this.state.imgData, 0, 0);\n    // copy image data into other canvas\n    this.swapImage(false);\n  }\n\n  swapImage(copyNew) {\n    if (this.state.imgData) {\n      let [canvasName, imgFile] = copyNew ? [\"canvas\", this.state.newData] : [\"newCanvas\", this.state.imgData];\n      const ctx = document.getElementById(canvasName).getContext(\"2d\");\n      ctx.putImageData(imgFile, 0, 0);\n      let data = new Uint8ClampedArray(imgFile.data);\n      let copy = new ImageData(data, imgFile.width, imgFile.height);\n      copyNew ? this.setState({ imgData: copy }) : this.setState({ newData: copy });\n    }\n  }\n\n  /*\n  -file1 and file2 are both ImageData objects\n  -oldVal and newVal are pixels (rgba values in an array)\n  -tolerance is an rgba range\n  searches the pixels in file1 looking for a match with oldVal within the given tolerance range.\n  corresponding pixels in file2 that were matched are changed to newVal\n  corresponding pixels in file2 that were unmatched are changed to the unmatched pixel\n  */\n  changeImgData(file1, file2, oldVal, newVal, tolerance) {\n    let match = false;\n    let imgData1 = file1.data;\n    let imgData2 = file2.data;\n    for (let i = 0; i < imgData1.length; i += 4) {\n      match = true;\n      for (let offset = 0; offset < 4; offset++) {\n        match = match && Math.abs(imgData1[i + offset] - oldVal[offset]) <= tolerance[offset];\n      }\n      if (match) {\n        for (let offset = 0; offset < 4; offset++) {\n          imgData2[i + offset] = newVal[offset];\n        }\n      } else {\n        for (let offset = 0; offset < 4; offset++) {\n          imgData2[i + offset] = imgData1[i + offset];\n        }\n      }\n    }\n  }\n\n  replace(file, oldVal, newVal, tolerance) {\n    if (file) {\n      this.changeImgData(this.state.imgData, file, oldVal, newVal, tolerance);\n      var canvas2 = document.getElementById(\"newCanvas\").getContext(\"2d\");\n      canvas2.putImageData(file, 0, 0);\n    }\n  }\n\n  // Download new image\n  download() {\n    const link = document.getElementById(\"download\");\n    if (this.state.imgData) {\n      var canvas = document.createElement(\"canvas\");\n      canvas.width = this.state.imgData.width;\n      canvas.height = this.state.imgData.height;\n      var ctx = canvas.getContext(\"2d\");\n      ctx.putImageData(this.state.newData, 0, 0);\n      link.setAttribute(\"href\", canvas.toDataURL());\n      link.click();\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <div className=\"grid\">\n          <label>Old Preview</label>\n          <label>New Preview</label>\n          <div className=\"transparent\" style={{ width: \"400px\", height: \"400px\" }}>\n            <canvas id=\"canvas\" style={{ width: \"400px\", height: \"400px\" }}></canvas>\n          </div>\n          <div className=\"transparent\" style={{ width: \"400px\", height: \"400px\" }}>\n            <canvas id=\"newCanvas\" style={{ width: \"400px\", height: \"400px\" }}></canvas>\n          </div>\n          <input id=\"upload\" type=\"file\" onChange={this.imageChange} hidden />\n          <button onClick={() => document.getElementById(\"upload\").click()}>Upload Image</button>\n          <button onClick={this.download}>Download</button>\n          <button onClick={() => this.swapImage(true)}>Copy new into old</button>\n          <button onClick={() => this.swapImage(false)}>Copy old into new</button>\n        </div>\n        <a id=\"download\" href=\"/\" style={{ display: \"none\" }} download=\"converted\">\n          Download\n        </a>\n        <Tools replace={this.replace} file={this.state.newData} />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}